<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Shadow Dump - Memory Forensics Challenge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #050816;
            color: #e5e7eb;
            line-height: 1.6;
        }

        a {
            color: #38bdf8;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .page {
            max-width: 960px;
            margin: 0 auto;
            padding: 32px 16px 64px;
        }

        header {
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 1px solid #1f2937;
        }

        .title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #f97316;
            margin-bottom: 4px;
        }

        .subtitle {
            font-size: 0.98rem;
            color: #9ca3af;
        }

        .meta-badges {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .badge {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid #374151;
            background: rgba(15, 23, 42, 0.8);
        }

        .badge--primary {
            border-color: #f97316;
            color: #fed7aa;
        }

        main {
            display: grid;
            grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
            gap: 24px;
        }

        @media (max-width: 800px) {
            main {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        section {
            margin-bottom: 24px;
            background: #020617;
            border-radius: 10px;
            border: 1px solid #111827;
            padding: 16px 18px 18px;
        }

        section h2 {
            font-size: 1rem;
            font-weight: 600;
            color: #e5e7eb;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        section p {
            font-size: 0.95rem;
            color: #d1d5db;
            margin-bottom: 10px;
        }

        ul {
            margin-left: 18px;
            font-size: 0.95rem;
            color: #d1d5db;
        }

        li+li {
            margin-top: 4px;
        }

        .label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #9ca3af;
            margin-bottom: 4px;
        }

        .flag-format {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            background: #020617;
            border-radius: 6px;
            border: 1px solid #1f2937;
            padding: 6px 10px;
            font-size: 0.9rem;
            display: inline-block;
            color: #fbbf24;
        }

        .assets-list {
            margin-top: 4px;
        }

        .asset-item {
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #1f2937;
            margin-top: 6px;
            background: #030712;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .asset-meta {
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 7px 14px;
            border-radius: 6px;
            border: 1px solid transparent;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            background: #0f172a;
            color: #e5e7eb;
        }

        .btn--primary {
            background: #f97316;
            border-color: #f97316;
            color: #111827;
        }

        .btn--primary:hover {
            background: #fb923c;
            border-color: #fb923c;
        }

        .btn--ghost {
            border-color: #374151;
        }

        .code-block {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            background: #020617;
            border-radius: 6px;
            border: 1px solid #111827;
            padding: 10px 12px;
            font-size: 0.85rem;
            white-space: pre;
            overflow-x: auto;
            color: #a5f3fc;
        }

        .hint-list li {
            font-size: 0.9rem;
        }

        /* Flag submission UI */
        .flag-form {
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .flag-input-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        @media (max-width: 600px) {
            .flag-input-row {
                flex-direction: column;
                align-items: stretch;
            }
        }

        .flag-input {
            flex: 1;
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #374151;
            background: #020617;
            color: #e5e7eb;
            font-family: inherit;
            font-size: 0.9rem;
        }

        .flag-input:focus {
            outline: none;
            border-color: #f97316;
            box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.6);
        }

        .flag-status {
            min-height: 20px;
            font-size: 0.9rem;
        }

        .flag-status--ok {
            color: #4ade80;
        }

        .flag-status--err {
            color: #fca5a5;
        }

        footer {
            margin-top: 32px;
            font-size: 0.8rem;
            color: #6b7280;
            border-top: 1px solid #111827;
            padding-top: 12px;
        }
    </style>
</head>

<body>
    <div class="page">
        <header>
            <div class="title">Shadow Dump</div>
            <div class="subtitle">Memory Forensics CTF Challenge</div>
            <div class="meta-badges">
                <span class="badge badge--primary">Memory Forensics</span>
                <span class="badge">Medium</span>
            </div>
        </header>

        <main>
            <div>
                <section>
                    <h2>Scenario</h2>
                    <p>
                        FinTech Solutions’ SOC received an alert at <strong>03:47 AM</strong> for unusual database
                        activity
                        originating from workstation <strong>WKSTN-2847</strong>. The endpoint detection system flagged
                        an
                        interactive login and the execution of unfamiliar scripts outside normal business hours.
                    </p>
                    <p>
                        Preliminary investigation revealed a Python process running with elevated privileges, attempting
                        connections outside the infrastructure. The analyst contained the workstation and captured
                        volatile memory before terminating the process. The forensic image is now with your team.
                    </p>
                    <p>
                        You are the Incident Response Analyst. Your objective is to examine the memory dump and
                        determine
                        what credentials or sensitive data were accessed. Process configuration data, memory, and heap
                        allocations may contain evidence of the intended exfiltration. Recover the complete secret
                        credential string.
                    </p>
                </section>

                <section>
                    <h2>Learning Outcomes</h2>
                    <ul>
                        <li>Volatile memory analysis using modern forensic frameworks.</li>
                        <li>Locating and reconstructing data from process memory allocations.</li>
                        <li>Identifying and decoding simple encoding used in memory artifacts.</li>
                    </ul>
                </section>

                <section>
                    <h2>Hints</h2>
                    <ul class="hint-list">
                        <li>Python running on a finance workstation at 03:47 AM is a strong lead.</li>
                        <li>Command line arguments often leak part of the attacker’s intent.</li>
                        <li>Heap memory is a good place to hunt for runtime secrets and credentials.</li>
                    </ul>
                </section>
            </div>

            <!-- Right column: assets + flag submission -->
            <div>
                <section>
                    <h2>Challenge Info</h2>
                    <div class="label">Category</div>
                    <p>Memory Forensics</p>

                    <div class="label">Difficulty</div>
                    <p>Medium</p>

                    <div class="label">Flag Format</div>
                    <span class="flag-format">CTF{...}</span>
                </section>

                <section>
                    <h2>Assets</h2>
                    <p class="label">Memory dump</p>
                    <div class="assets-list">
                        <div class="asset-item">
                            <div>
                                <div><code>memdump.mem</code></div>
                                <div class="asset-meta">Windows 10 x64 Dump ~1 GB</div>
                            </div>
                            <a class="btn btn--primary"
                                href="https://github.com/5h1Vm/memdmp-chal/raw/refs/heads/main/memdump.mem?download="
                                download>
                                Download
                            </a>
                        </div>
                    </div>
                    <p class="asset-meta" style="margin-top:8px;">
                    </p>
                </section>

                <section>
                    <h2>Submit Flag (Local Check)</h2>
                    <p style="font-size:0.9rem; color:#9ca3af; margin-bottom:6px;">
                        Client-side check for practice only. For a real CTF platform, use a server-side validator.
                    </p>

                    <form class="flag-form" onsubmit="return false;">
                        <div class="flag-input-row">
                            <input id="flag-input" class="flag-input" type="text"
                                placeholder="Enter flag, e.g. CTF{...}" autocomplete="off" />
                            <button type="button" class="btn btn--ghost" onclick="checkFlag()">
                                Submit
                            </button>
                        </div>
                        <div id="flag-status" class="flag-status"></div>
                    </form>
                </section>
            </div>
        </main>
        <center>
            <footer>
                <div>GitHub: <a href="https://github.com/5h1Vm/memdmp-chal">5h1Vm/memdmp-chal</a></div>
                <div>For educational and training use.</div>
            </footer>
        </center>
    </div>

    <script>
        const EXPECTED_FLAG_SHA256 = "e1cd6ecc04ed162332ba929b1f7b079ec46a01159290d5098f82e99ecd81dd51";

        async function sha256Hex(input) {
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
        }

        async function checkFlag() {
            const inputEl = document.getElementById("flag-input");
            const statusEl = document.getElementById("flag-status");
            const flag = (inputEl.value || "").trim();

            statusEl.textContent = "";
            statusEl.classList.remove("flag-status--ok", "flag-status--err");

            if (!flag) {
                statusEl.textContent = "Enter a flag first.";
                statusEl.classList.add("flag-status--err");
                return;
            }

            try {
                const hash = await sha256Hex(flag);

                if (hash === EXPECTED_FLAG_SHA256) {
                    statusEl.textContent = "Correct flag. Nice work.";
                    statusEl.classList.add("flag-status--ok");
                } else {
                    statusEl.textContent = "Incorrect flag. Keep digging in memory.";
                    statusEl.classList.add("flag-status--err");
                }
            } catch (e) {
                statusEl.textContent = "Your browser does not support Web Crypto API.";
                statusEl.classList.add("flag-status--err");
            }
        }
    </script>
</body>

</html>